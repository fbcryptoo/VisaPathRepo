<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VisaPath – Do I Need a Visa?</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f6f7fb;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    header {
      background-color: #ffffff;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #1e6ef1;
      font-size: 2em;
      margin: 0;
    }
    .container {
      max-width: 500px;
      margin: 40px auto;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }
    h2 {
      font-size: 1.6em;
      margin-bottom: 15px;
      color: #222;
    }
    p {
      font-size: 1em;
      color: #555;
      margin-bottom: 30px;
    }
    select, button {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      font-size: 1em;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #1e6ef1;
      color: white;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    button:hover {
      background-color: #155dd8;
    }
    #result {
      margin-top: 25px;
      background-color: #fff7d9;
      border-left: 4px solid #f2c037;
      padding: 15px;
      border-radius: 8px;
      color: #333;
    }
    a {
      color: #1e6ef1;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <header>
    <h1>VisaPath</h1>
  </header>

  <div class="container">
    <h2>Do I need a visa?</h2>
    <p>Use our smart visa checker to instantly find out visa requirements between any two countries—<br/>including e-visas, eTAs, ESTA, and visa-free entry.</p>

    <select id="from"></select>
    <select id="to"></select>
    <button onclick="checkVisa()">Check Visa Requirement</button>

    <div id="result"></div>
  </div>

  <script>
    let data = [];

    async function loadData() {
      const response = await fetch('combined_passport_data_with_guidance.csv');
      const text = await response.text();
      const rows = text.trim().split('\n').slice(1);
      data = rows.map(row => {
        const [from, to, requirement, guidance] = row.split(',');
        return {
          from: from.trim(),
          to: to.trim(),
          requirement: requirement.trim().toLowerCase(),
          guidance: guidance ? guidance.trim() : ''
        };
      });

      const countries = Array.from(new Set(data.flatMap(d => [d.from, d.to]))).sort();
      const fromSelect = document.getElementById('from');
      const toSelect = document.getElementById('to');

      countries.forEach(country => {
        const opt1 = document.createElement('option');
        opt1.value = country;
        opt1.textContent = country;
        fromSelect.appendChild(opt1);

        const opt2 = document.createElement('option');
        opt2.value = country;
        opt2.textContent = country;
        toSelect.appendChild(opt2);
      });
    }

    function checkVisa() {
      const from = document.getElementById('from').value;
      const to = document.getElementById('to').value;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '';

      if (!from || !to) {
        resultDiv.innerHTML = 'Please select both countries.';
        return;
      }

      const info = data.find(d => d.from === from && d.to === to);

      if (!info) {
        resultDiv.innerHTML = `We couldn't find visa information for ${from} → ${to}.`;
        return;
      }

      let msg = `<strong>${from} → ${to}</strong><br/><br/>`;

      switch (info.requirement) {
        case 'visa':
          msg += `You’ll need to apply for a visa to travel from ${from} to ${to}.<br/><br/>Please check with the destination’s embassy or consulate for the most accurate application instructions.`;
          break;
        case 'visa_free':
          msg += `No visa required to enter ${to} — it's visa-free.`;
          break;
        case 'eta':
        case 'e-visa':
        case 'esta':
          msg += `You need to apply for an <strong>${info.requirement.toUpperCase()}</strong> to travel to ${to}.`;
          break;
        default:
          msg += `Visa requirement: ${info.requirement}`;
      }

      if (info.guidance && info.guidance.startsWith('http')) {
        msg += `<br/><br/><a href="${info.guidance}" target="_blank">Apply or learn more here</a>`;
      }

      resultDiv.innerHTML = msg;
    }

    window.onload = loadData;
  </script>
</body>
</html>
