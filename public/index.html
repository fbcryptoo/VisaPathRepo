<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VisaPath</title>
</head>
<body>
  <h1>VisaPath</h1>
  <select id="nationality"></select>
  <select id="destination"></select>
  <button onclick="checkVisa()">Check Visa</button>
  <div id="results"></div>

  <script>
    let data = {};

    fetch('combined_passport_data_with_guidance.csv')
      .then(response => response.text())
      .then(csv => {
        const lines = csv.split('\n');
        const headers = lines[0].split(',');
        for (let i = 1; i < lines.length; i++) {
          const cols = lines[i].split(',');
          const from = cols[0].trim();
          const to = cols[1].trim();
          const requirement = cols[2].trim();
          const guidance = cols[3]?.trim();
          if (!data[from]) data[from] = {};
          data[from][to] = { requirement, guidance };
        }

        // Populate dropdowns
        const countries = Object.keys(data);
        const nationalitySelect = document.getElementById('nationality');
        const destinationSelect = document.getElementById('destination');
        countries.forEach(c => {
          nationalitySelect.innerHTML += `<option>${c}</option>`;
          destinationSelect.innerHTML += `<option>${c}</option>`;
        });
      });

    function checkVisa() {
      const from = document.getElementById('nationality').value;
      const to = document.getElementById('destination').value;
      const info = data[from]?.[to];
      const resultDiv = document.getElementById('results');
      if (info) {
        resultDiv.innerHTML = `
          <p><strong>${from} â†’ ${to}</strong></p>
          <p>Requirement: ${info.requirement}</p>
          <p>${info.guidance}</p>
        `;
      } else {
        resultDiv.innerHTML = 'No data available.';
      }
    }
  </script>
</body>
</html>
